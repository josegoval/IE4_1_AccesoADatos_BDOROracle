 ---------------------
| CREACIÓN DE OBJETOS |
 ---------------------

	-- ASIGNATURA --

CREATE OR REPLACE TYPE TIPO_ASIGNATURA AS OBJECT (
	COD_ASIG NUMBER(4),
	NOMBRE VARCHAR2(80),
	TIPO VARCHAR(50),
	MEMBER FUNCTION VALIDAR_TIPO RETURN NUMBER
);

CREATE OR REPLACE TYPE BODY TIPO_ASIGNATURA AS
	MEMBER FUNCTION VALIDAR_TIPO RETURN NUMBER IS
	BEGIN
		IF TIPO = 'OPTATIVA' OR TIPO = 'OBLIGATORIA' OR TIPO = 'LIBRE CONFIGURACION'
			THEN RETURN 1;
		ELSE RETURN 0;
		END IF;
	END;
END;

	-- CURSO --

CREATE OR REPLACE TYPE TIPO_CURSO AS OBJECT (
	ID_CURSO NUMBER(4),
	DESCRIPCION VARCHAR2(60),
	NIVEL VARCHAR2(3),
	TURNO CHAR,
	MEMBER FUNCTION VALIDAR_TURNO RETURN NUMBER
);

CREATE OR REPLACE TYPE BODY TIPO_CURSO AS
	MEMBER FUNCTION VALIDAR_TURNO RETURN NUMBER IS
	BEGIN
		IF TURNO = 'D' OR TURNO = 'N'
			THEN RETURN 1;
		ELSE RETURN 0;
		END IF;
	END;
END;

	-- ALUMNO --

CREATE OR REPLACE TYPE TIPO_DIRECCION AS OBJECT (
	DIRECCION VARCHAR2(50),
	POBLACION VARCHAR2(50),
	CODPOSTAL NUMBER(5),
	PROVINCIA VARCHAR(40)
);

CREATE OR REPLACE TYPE TYPE_TELEFONOS AS VARRAY(2) OF VARCHAR2(15);

CREATE OR REPLACE TYPE TIPO_NOTAS AS OBJECT (
	ASIGNATURA REF TIPO_ASIGNATURA,
	NOTA1EV	NUMBER(4,2),
	NOTA2EV	NUMBER(4,2),
	NOTA3EV	NUMBER(4,2),
	NOTAFJUN NUMBER(4,2),
	NOTASEPT NUMBER(4,2)
);

CREATE OR REPLACE TYPE TIPO_TABLA_ANIDADA_NOTAS AS TABLE OF TIPO_NOTAS;

CREATE OR REPLACE TYPE TIPO_ALUMNO AS OBJECT (
	DNI VARCHAR2(10),
	NOMBRE VARCHAR2(50),
	DIRECCION TIPO_DIRECCION,
	TELEFONOS TYPE_TELEFONOS,
	FECHA_NAC DATE,
	CURSO REF TIPO_CURSO,
	TNOTAS TIPO_TABLA_ANIDADA_NOTAS
);

 --------------------
| CREACIÓN DE TABLAS |
 --------------------

CREATE TABLE TASIGNATURAS OF TIPO_ASIGNATURA (
	COD_ASIG PRIMARY KEY 
);

CREATE TABLE TCURSOS OF TIPO_CURSO (
	ID_CURSO PRIMARY KEY 
);

CREATE TABLE TALUMNOS OF TIPO_ALUMNO (
	DNI PRIMARY KEY 
)NESTED TABLE TNOTAS STORE AS TNOTAS_ANIDADA;